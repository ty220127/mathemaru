
<link rel="stylesheet" href="https://ty220127.github.io/problemath/sample.css"/>
<html>
<head>
<script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML">
	MathJax.Hub.Config({ tex2jax: { inlineMath: [['$','$'], ["\\(","\\)"]] } });	
	MathJax.Hub.Config({ TeX: { Macros: {
		refeq: ['\\underset{\\href{#1}{\\scriptsize\\sf[\\# #2]}}{=}',2],
		reflr: ['\\underset{\\href{#1}{\\scriptsize\\sf[\\# #2]}}{\\Longleftrightarrow}',2],
		refr: ['\\underset{\\href{#1}{\\scriptsize\\sf[\\# #2]}}{\\Longrightarrow}',2],
		bs: '\\boldsymbol', 
		bcu: '\\displaystyle\\bigcup', 
		bsqcu: '\\displaystyle\\bigsqcup', 
		bca: '\\displaystyle\\bigcap', 
		fraction: ['\\displaystyle\\frac{#1}{#2}', 2],
		limit: '\\displaystyle\\lim',
		sig: '\\displaystyle\\sum',
		cpl: '\\mathrm{c}',
		trp: '\\mathsf{T}',
		rd: '\\mathrm{d}',
		intgrl: '\\displaystyle\\int',
	}}});
</script>
<script>
	const ttl = "条件付き確率"
	document.title= ttl + "｜演習問題集"
</script>
<meta name="viewport" content="width=device-width,initial-scale=1.0,user-scalable=yes" />
</head>

<body>
<center><div id="titlehead"><script>document.write(ttl)</script></div></center>
<p style="text-align:right;">
established on 2022/5/1<br>
updated on 2022/5/3
</p>
   
<div class="def" id="201">
<b>[#201] 定義：条件付き確率</b><br>
	<p> $(\varOmega,\,\mathcal{F},\,P)$ を確率空間とし，$A,\,B\in\mathcal{F}$，$P(B)\gt 0$ とする．このとき，以下で定義される $P(A\,|\,B)$ を事象 $A$ の下での事象 $B$ の【条件付き確率 (conditional probability)】と呼ぶ：</p>
	<p><center>\begin{align*}
		P(A\,|\,B) = \fraction{P(A\cap B)}{P(B)}.
		\end{align*}</center></p>
</div>
<br><br>

<div class="prp" id="202">
<b>[#202] 命題：全確率の公式 (law of total probability)</b><br>
	<p> $(\varOmega,\,\mathcal{F},\,P)$ を確率空間とし，$A\in\mathcal{F}$ とする．また，集合列 $\{B_k\}_{k=1}^{n}\subset \mathcal{F}$ は互いに排反で $\bigsqcup_{k=1}^{n}B_k = \varOmega$ を満たし，更にすべての $k\in\{1,\,\cdots,\,n\}$ に対し $P(B_k)\gt 0$ とする．以上の下で，以下が成り立つ：</p>
	<p><center>\begin{align*}
		P(A) = \sum_{k=1}^{n}P(A\,|\,B_k)P(B_k).
		\end{align*}</center></p>
</div>
<Details>
<summary>証明</summary>
	<p>集合列を用いた測度の分解 <a href="measure.html#206">[#206]</a> より</p>
	<p><center>\begin{align*}
		P(A) = \sum_{k=1}^{n}P(A\cap B_k).
		\end{align*}</center></p>
	<p>ここで，条件付き確率の定義 <a href="#201">[#201]</a> より，$k=1,\,\cdots,\,n$ に対して</p>
	<p><center>\begin{align*}
		P(A\cap B_k) = P(A\,|\,B_k)P(B_k).
		\end{align*}</center></p>
	<p>以上の議論をまとめることで題意を得る．</p>
</Details>
<br><br>

<div class="prp" id="203">
<b>[#203] 命題：<ruby><rb>Bayes</rb><rp>（</rp><rt>ベイズ</rt><rp>）</rp></ruby> の定理 (Bayes' theorem)</b><br>
	<p> $(\varOmega,\,\mathcal{F},\,P)$ を確率空間とし，集合列 $\{H_k\}_{k=1}^{n}\subset \mathcal{F}$ は互いに排反で $\bigsqcup_{k=1}^{n}H_k = \varOmega$ を満たし，更にすべての $k\in\{1,\,\cdots,\,n\}$ に対し $P(H_k)\gt 0$ とする．このとき，$P(A)\gt 0$ を満たす事象 $A\in\mathcal{F}$ に対して</p>
	<p><center>\begin{align*}
		P(H_j\,|\,A) = \fraction{P(A\,|\,H_j)P(H_j)}{\sum_{k=1}^{n}P(A\,|\,H_k)P(H_k)}\quad(j=1,\,\cdots,\,n).
		\end{align*}</center></p>
</div>
<Details>
<summary>証明</summary>
	<p>条件付き確率の定義 <a href="#201">[#201]</a> より，$j=1,\,\cdots,\,n$ に対して</p>
	<p><center>\begin{align*}
		P(A\cap H_j) = P(A\,|\,H_j)P(H_j).
		\end{align*}</center></p>
	<p>一方，集合の交換法則 <a href="set.html#52">[#52]</a> より $A\cap H_j = H_j \cap A$ であることから</p>
	<p><center>\begin{align*}
		P(A\cap H_j) = P(H_j\cap A) \refeq{#201}{201} P(H_j\,|\,A)P(A).
		\end{align*}</center></p>
	<p>以上により，$P(A)\gt 0$ に注意して</p>
	<p><center>\begin{align*}
		P(H_j\,|\,A)P(A) = P(A\,|\,H_j)P(H_j),\quad\text{i.e.,}\quad P(H_j\,|\,A) = \fraction{P(A\,|\,H_j)P(H_j)}{P(A)}.
		\end{align*}</center></p>
	<p>最後に，全確率の公式 <a href="#202">[#202]</a> より</p>
	<p><center>\begin{align*}
		P(H_j\,|\,A) = \fraction{P(A\,|\,H_j)P(H_j)}{\sum_{k=1}^{n}P(A\,|\,H_k)P(H_k)}.
		\end{align*}</center></p>
</Details>
<Details>
<summary>補足</summary>
	<p>Bayes の定理において，しばしば事象 $A$ は「結果」，事象 $H_k$ たちは「原因」と解釈される．また $P(H_k)$ は【事前確率 (prior probability)】，$P(H_k\,|\,A)$ は【事後確率 (posterior probability)】と呼ばれる．この定理はある $H_j$ に対する事後確率を求めるための式であるが，これは $A$ という結果が起こった原因が $H_j$ である確率を表している．つまり，Bayes の定理は結果から原因を検討するための定理と云える．</p>
</Details>
<br><br>

<div class="exm" id="207">
<b>[#207] 例題：事後確率の求値</b><br>
	<p>いろいろな動物の絵がプリントされているクッキーを，工場 A と工場 B で生産している．工場 A で製造されたクッキーの箱の中には $2\,\%$ の確率でカモノハシの絵がプリントされているクッキーが入っており，工場 B で製造されたクッキーの箱の中には $8\,\%$ の確率でカモノハシの絵がプリントされているクッキーが入っている．ある商店のうち，$70\,\%$ を工場 A から，$30\,\%$ を工場 B から仕入れている．</p>
	<ol>
	<li><p>仕入れたクッキーの箱を無作為に $1$ 個抽出する．このクッキーの箱の中にカモノハシの絵がプリントされているクッキーが入っている確率はいくらか．</p></li>
	<li><p>仕入れたクッキーの箱を無作為に $1$ 個抽出したところ，箱の中にカモノハシの絵がプリントされているクッキーが入っていた．このとき，このクッキーが工場 A で製造された確率はいくらか．</p></li>
	</ol>
	<p>解答は小数第 4 位を四捨五入せよ．</p>
	<p style="text-align:right;">[2018.11 統計検定 2級]</p>
</div>
<Details>
<summary>解答</summary>
</Details>
<br><br>

<div class="exr" id="208">
<b>[#208] 演習：独立な事象 → <a href="independence.html#209">[#209]</a></b><br>
	<p> 1 から 6 までの目が 1 つずつ書かれた六面体サイコロ A, B を投げたところ，サイコロ B の出た目は 6 であった．このときサイコロ A の出た目も 6 である確率を求めよ．</p>
</div>
<Details>
<summary>解答</summary>
</Details>
<Details>
<summary>補足</summary>
	<p>この結果は，サイコロ B のことを一切忘れ，ただ単にサイコロ A を投げて 6 の目が出る確率に等しいし，直感的にもそれが自然である．これは，サイコロ B における結果がサイコロ A における結果に影響を及ぼさないことが予測できるからである．このような状況を，A と B は【独立 (independent)】であると云う．ところで，この場合の条件付き確率 $P(A\,|\,B)$ と 通常の確率 $P(A)$ の関係 $P(A\,|\,B)=P(A)$ を条件付き確率の定義式に代入し整理すると</p>
	<p><center>\begin{align*}
		P(A\cap B)=P(A)P(B)
		\end{align*}</center></p>
	<p>という関係式を得る．数学的な独立の定義式はこの形とされている（分母を払うことで $P(A)$ ないし $P(B)$ が $0$ となるケースにも対応している）．</p>
</Details>
<br><br>

<div id="bib">
<b>参考文献</b>
	<ul>
		<li>熊谷隆: 新しい解析学の流れ 確率論, 共立出版 (2003).</li>
		<li>今野紀雄, 井手勇介, 瀬川悦生, 竹居正登, 大塚一路: 横浜発 確率・統計入門, 産業図書 (2014).</li>
		<li>東京大学教養学部統計学教室: 基礎統計学I 統計学入門, 東京大学出版会 (1991).</li>
		<li>舟木直久: 講座＜数学の考え方＞20 確率論, 朝倉書店, (2004).</li>
</ul>
</div>
<b>その他参考コンテンツ</b>
<center>
<iframe width="480" height="270" src="https://www.youtube.com/embed/oUN_GhB00fU" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
</center>
      
<p style="text-align:right;">
<a href="index.html">トップページに戻る</a>
</p>
</body>
</html>
